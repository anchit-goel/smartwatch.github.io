(self.AMP=self.AMP||[]).push({n:"amp-user-notification",v:"2006050512000",f:(function(AMP,_){
var l,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function ba(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object");})()}ba(this);"function"===typeof Symbol&&Symbol("x");var m;
if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var n;a:{var ca={a:!0},p={};try{p.__proto__=ca;n=p.a;break a}catch(a){}n=!1}m=n?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var q=m,r;function t(){return r?r:r=Promise.resolve(void 0)};function u(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b};function v(){this.h=0;this.R=t();this.O=function(){};this.P=function(){}}v.prototype.onQueueEmpty=function(a){this.O=a;0==this.h&&a()};v.prototype.onQueueNotEmpty=function(a){this.P=a;0<this.h&&a()};v.prototype.registerUI=function(a){var b=this;0==this.h&&this.P();this.h++;var c=this.R.then(function(){return a().then(function(){b.h--;0==b.h&&b.O()})});return this.R=c};function w(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var da=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;var x=self.AMP_CONFIG||{},ea=("string"==typeof x.cdnProxyRegex?new RegExp(x.cdnProxyRegex):x.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function y(a){if(self.document&&self.document.head&&(!self.location||!ea.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}x.cdnUrl||y("runtime-host");x.geoApiUrl||y("amp-geo-api");function fa(a){for(var b=null,c="",d=0;d<arguments.length;d++){var f=arguments[d];if(f instanceof Error&&!b){b=void 0;var e=Object.getOwnPropertyDescriptor(f,"message");if(e&&e.writable)b=f;else{e=f.stack;var g=Error(f.message);for(b in f)g[b]=f[b];g.stack=e;b=g}}else c&&(c+=" "),c+=f}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function ha(a){var b=fa.apply(null,arguments);setTimeout(function(){self.__AMP_REPORT_ERROR(b);throw b;})}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};
var z=self.__AMP_LOG;function B(){if(!z.user)throw Error("failed to call initLogConstructor");return z.user}function C(){if(z.dev)return z.dev;throw Error("failed to call initLogConstructor");}function D(a,b,c,d,f){return B().assert(a,b,c,d,f,void 0,void 0,void 0,void 0,void 0,void 0)};var E=Object.prototype.hasOwnProperty;function F(a){return a||{}};function G(){this.U=100;this.C=this.G=0;this.o=Object.create(null)}G.prototype.has=function(a){return!!this.o[a]};G.prototype.get=function(a){var b=this.o[a];if(b)return b.access=++this.C,b.payload};G.prototype.put=function(a,b){this.has(a)||this.G++;this.o[a]={payload:b,access:this.C};if(!(this.G<=this.U)){C().warn("lru-cache","Trimming LRU cache");a=this.o;var c=this.C+1,d;for(d in a){var f=a[d].access;if(f<c){c=f;var e=d}}void 0!==e&&(delete a[e],this.G--)}};F({c:!0,v:!0,a:!0,ad:!0,action:!0});var H,I;
function J(a,b){var c=void 0===c?"source":c;D(null!=a,"%s %s must be available",b,c);var d=a;if("string"==typeof d){H||(H=self.document.createElement("a"),I=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new G));var f=I,e=H;if(f&&f.has(d))d=f.get(d);else{e.href=d;e.protocol||(e.href=e.href);var g={href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:"0"==e.port?"":e.port,pathname:e.pathname,search:e.search,hash:e.hash,origin:null};"/"!==g.pathname[0]&&(g.pathname="/"+g.pathname);if("http:"==
g.protocol&&80==g.port||"https:"==g.protocol&&443==g.port)g.port="",g.host=g.hostname;g.origin=e.origin&&"null"!=e.origin?e.origin:"data:"!=g.protocol&&g.host?g.protocol+"//"+g.host:g.href;f&&f.put(d,g);d=g}}(f="https:"==d.protocol||"localhost"==d.hostname||"127.0.0.1"==d.hostname)||(d=d.hostname,f=d.length-10,f=0<=f&&d.indexOf(".localhost",f)==f);D(f||/^(\/\/)/.test(a),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,
a)};function K(a){if(a.__AMP__EXPERIMENT_TOGGLES)return a.__AMP__EXPERIMENT_TOGGLES;a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);var b=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(b[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length){var f=a.AMP_CONFIG["allow-doc-opt-in"],e=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]');
if(e){var g=e.getAttribute("content").split(",");for(c=0;c<g.length;c++)-1!=f.indexOf(g[c])&&(b[g[c]]=!0)}}Object.assign(b,ia(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){c=a.AMP_CONFIG["allow-url-opt-in"];var h=a.location.originalHash||a.location.hash;a=Object.create(null);if(h)for(var k;k=da.exec(h);){var A=w(k[1],k[1]);k=k[2]?w(k[2].replace(/\+/g," "),k[2]):"";a[A]=k}for(h=0;h<c.length;h++)A=a["e-"+c[h]],"1"==A&&(b[c[h]]=!0),"0"==
A&&(b[c[h]]=!1)}return b}function ia(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(f){C().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var d=0;d<c.length;d++)0!=c[d].length&&("-"==c[d][0]?a[c[d].substr(1)]=!1:a[c[d]]=!0);return a};var L={},M=(L["ampdoc-fie"]={isTrafficEligible:function(){return!0},branches:[["21065001"],["21065002"]]},L);function ja(a){var b=a.ownerDocument.defaultView,c=b.__AMP_TOP||(b.__AMP_TOP=b),d=b!=c;if(K(c)["ampdoc-fie"]){c.__AMP_EXPERIMENT_BRANCHES=c.__AMP_EXPERIMENT_BRANCHES||{};for(e in M)if(E.call(M,e)&&!E.call(c.__AMP_EXPERIMENT_BRANCHES,e))if(M[e].isTrafficEligible&&M[e].isTrafficEligible(c)){var f;if(f=!c.__AMP_EXPERIMENT_BRANCHES[e])f=e,f=!!K(c)[f];f&&(f=M[e].branches,c.__AMP_EXPERIMENT_BRANCHES[e]=f[Math.floor(Math.random()*f.length)]||null)}else c.__AMP_EXPERIMENT_BRANCHES[e]=null;var e="21065002"===
(c.__AMP_EXPERIMENT_BRANCHES?c.__AMP_EXPERIMENT_BRANCHES["ampdoc-fie"]:null)}else e=!1;var g=e;d&&!g?a=N(b,"url-replace")?O(b,"url-replace"):null:(a=P(a),a=Q(a),a=N(a,"url-replace")?O(a,"url-replace"):null);return a}function R(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return O(a,b)}function P(a){return a.nodeType?R((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function Q(a){a=P(a);return a.isSingleDoc()?a.win:a}
function O(a,b){N(a,b);a=S(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function T(a,b){var c=U(a,b);if(c)return c;a=S(a);a[b]=ka();return a[b].promise}function U(a,b){var c=S(a)[b];if(c){if(c.promise)return c.promise;O(a,b);return c.promise=Promise.resolve(c.obj)}return null}function S(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}
function N(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}function ka(){var a=new u,b=a.promise,c=a.resolve;a=a.reject;b.catch(function(){});return{obj:null,promise:b,resolve:c,reject:a,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function la(a){var b=U(Q(a),"geo");if(b)return b;var c=P(a);return c.waitForBodyOpen().then(function(){var a=c.win;var b=c.win.document.head;if(b){var e={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var g=0;g<b.length;g++){var h=b[g];h=h.getAttribute("custom-element")||h.getAttribute("custom-template");e[h]=!0}e=Object.keys(e)}else e=[];return e.includes("amp-geo")?R(a,"extensions").waitForExtension(a,"amp-geo"):t()}).then(function(){return U(Q(a),"geo")})};function V(a){a=AMP.BaseElement.call(this,a)||this;a.J=null;a.m=null;var b=new u;a.K=b.promise;a.L=b.resolve;a.l=null;a.F=!1;a.A=null;a.B=null;a.w=null;a.j=null;a.H="";a.I=null;a.T=null;return a}var W=AMP.BaseElement;V.prototype=aa(W.prototype);V.prototype.constructor=V;if(q)q(V,W);else for(var X in W)if("prototype"!=X)if(Object.defineProperties){var Y=Object.getOwnPropertyDescriptor(W,X);Y&&Object.defineProperty(V,X,Y)}else V[X]=W[X];V.Y=W.prototype;l=V.prototype;l.isAlwaysFixed=function(){return!0};
l.buildCallback=function(){var a=this,b=this.getAmpDoc();this.T=ja(this.element);this.I=T(Q(this.element),"storage");this.m=D(this.element.id,"amp-user-notification should have an id.");this.H="amp-user-notification:"+this.m;this.A=this.element.getAttribute("data-show-if-geo");this.B=this.element.getAttribute("data-show-if-not-geo");(this.j=this.element.getAttribute("data-show-if-href"))&&J(this.j,this.element);D(1>=!!this.j+!!this.A+!!this.B,'Only one "data-show-if-*" attribute allowed');this.A&&
(this.w=ma(this,this.A,!0));this.B&&(this.w=ma(this,this.B,!1));(this.l=this.element.getAttribute("data-dismiss-href"))&&J(this.l,this.element);this.element.getAttribute("role")||this.element.setAttribute("role","alert");var c=this.element.getAttribute("data-persist-dismissal");this.F="false"!=c&&"no"!=c;this.registerDefaultAction(function(){return a.dismiss(!1)},"dismiss");this.registerAction("optoutOfCid",function(){return na(a)});T(Q(b),"userNotificationManager").then(function(b){b.registerUserNotification(a.m,
a)})};function ma(a,b,c){return la(a.element).then(function(a){D(a,"requires <amp-geo> to use promptIfUnknownForGeoGroup");var d=b.split(/,\s*/).filter(function(b){return 2==a.isInCountryGroup(b)});return!(c?!d.length:d.length)})}
function oa(a,b){return a.T.expandUrlAsync(a.j).then(function(c){var d={elementId:a.m,ampUserId:b};var f=[];for(var e in d){var g=d[e];if(null!=g)if(Array.isArray(g))for(var h=0;h<g.length;h++){var k=g[h];f.push(encodeURIComponent(e)+"="+encodeURIComponent(k))}else f.push(encodeURIComponent(e)+"="+encodeURIComponent(g))}f=f.join("&");f?(d=c.split("#",2),e=d[0].split("?",2),f=e[0]+(e[1]?"?"+e[1]+"&"+f:"?"+f),d=f+=d[1]?"#"+d[1]:""):d=c;return d})}
l.V=function(a){var b=this;this.J=a;return oa(this,a).then(function(a){return R(b.win,"xhr").fetchJson(a,{credentials:"include"}).then(function(a){return a.json()})})};function pa(a){var b=a.element.getAttribute("enctype")||"application/json;charset=utf-8";R(a.win,"xhr").fetchJson(a.l,{method:"POST",credentials:"include",body:F({elementId:a.m,ampUserId:a.J}),headers:{"Content-Type":b}})}
l.X=function(a){D("boolean"==typeof a.showNotification,'`showNotification` should be a boolean. Got "%s" which is of type %s.',a.showNotification,typeof a.showNotification);a.showNotification||this.L();return Promise.resolve(a.showNotification)};function na(a){return T(Q(a.element),"cid").then(function(a){return a.optOut()}).then(function(){return a.dismiss(!1)},function(b){C().error("amp-user-notification","Failed to opt out of Cid",b);a.dismiss(!0)})}
function qa(a){return T(Q(a.element),"cid").then(function(b){return b.get({scope:"amp-user-notification",createCookieIfNotPresent:!0},t(),a.K)})}l.shouldShow=function(){var a=this;return this.isDismissed().then(function(b){return b?!1:a.j?qa(a).then(a.V.bind(a)).then(a.X.bind(a)):a.w?a.w:!0})};
l.show=function(){var a=this.element,b=!0;void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","");this.element.classList.add("amp-active");this.getViewport().addToFixedLayer(this.element);return this.K};l.isDismissed=function(){var a=this;return this.F?this.I.then(function(b){return b.get(a.H)}).then(function(a){return!!a},function(a){C().error("amp-user-notification","Failed to read storage",a);return!1}):Promise.resolve(!1)};
l.dismiss=function(a){var b=this;this.element.classList.remove("amp-active");this.element.classList.add("amp-hidden");this.L();this.getViewport().removeFromFixedLayer(this.element);this.F&&!a&&this.I.then(function(a){a.set(b.H,!0)});this.l&&pa(this)};function Z(a){this.ampdoc=a;this.S=Object.create(null);this.D=Object.create(null);this.M=this.ampdoc.whenReady();this.N=Promise.all([this.ampdoc.whenFirstVisible(),this.M]);this.W=T(Q(this.ampdoc),"notificationUIManager")}
Z.prototype.get=function(a){var b=this;this.N.then(function(){null==b.ampdoc.getElementById(a)&&B().warn("amp-user-notification","Did not find amp-user-notification element "+a+".")});return ra(this,a).promise};Z.prototype.getNotification=function(a){var b=this;return this.M.then(function(){return b.S[a]})};
Z.prototype.registerUserNotification=function(a,b){var c=this;this.S[a]=b;var d=ra(this,a);return this.N.then(function(){return b.shouldShow()}).then(function(a){if(a)return c.W.then(function(a){return a.registerUI(b.show.bind(b))})}).then(d.resolve.bind(this,b)).catch(ha.bind(null,"Notification service failed amp-user-notification",a))};function ra(a,b){if(a.D[b])return a.D[b];var c=new u;return a.D[b]={promise:c.promise,resolve:c.resolve}}
(function(a){a.registerServiceForDoc("userNotificationManager",Z);a.registerServiceForDoc("notificationUIManager",v);a.registerElement("amp-user-notification",V,"amp-user-notification{position:fixed!important;bottom:0;left:0;overflow:hidden!important;visibility:hidden;background:hsla(0,0%,100%,0.7);z-index:1000;width:100%}amp-user-notification.amp-active{visibility:visible}amp-user-notification.amp-hidden{visibility:hidden}\n/*# sourceURL=/extensions/amp-user-notification/0.1/amp-user-notification.css*/")})(self.AMP);
})});

//# sourceMappingURL=amp-user-notification-0.1.js.map
